import java.io.*;
import java.util.*;




public class FordFulkerson {

	
	public static ArrayList<Integer> pathDFS(Integer source, Integer destination, WGraph graph){
		ArrayList<Integer> Stack = new ArrayList<Integer>();
		// YOUR CODE GOES HERE
		//Start at source, continue until you hit dest
		int[] color = new int[graph.getNbNodes()];
		int[] d = new int[graph.getNbNodes()];
		int time=0;
		int numDone=0;
		for(int i=0; i<color.length; i++)
			color[i]=0;	//Init all nodes to white
		ArrayList<Integer> allNodes = new ArrayList<Integer>();
		for(Edge e: graph.getEdges()){
			if(allNodes.contains(e.nodes[0])==false )
				allNodes.add(e.nodes[0]);
			if(allNodes.contains(e.nodes[1])==false )
				allNodes.add(e.nodes[1]);
		}
		
		ArrayList<ArrayList<Integer>> adjList = new ArrayList<ArrayList<Integer>>(graph.getNbNodes());
		for(int i=0; i<graph.getNbNodes(); i++)
			adjList.add(new ArrayList<Integer>());
		
		for(int i=0; i<graph.getEdges().size(); i++){
			Edge edge=graph.getEdges().get(i);
			int n0=edge.nodes[0];
			int n1=edge.nodes[1];
			adjList.get(n0).add(n1);	//Add n1 to n0's adj list
		}
		
		//DFS(source,destination, graph,allNodes,adjList,color,numDone,Stack);
		return DFS(source,destination, graph,allNodes,adjList,color,numDone, Stack);
	}
	public static ArrayList<Integer> DFS(Integer source, Integer destination, WGraph graph, ArrayList<Integer> allNodes,ArrayList<ArrayList<Integer>> adjList, int[] color, int numDone,ArrayList<Integer> Stack ){
		color[source]=1;	//Mark Grey
		if(source==destination){
			Stack.add(destination);
			return Stack;
		}
		for(int v: adjList.get(source) ){
			if(color[v]==0){
				Stack.add(source);
				DFS(v,destination,graph,allNodes,adjList,color, numDone,Stack);
			}				
		}
		color[source]=2;	//Mark Black
		numDone++;
		if(numDone==graph.getNbNodes() && source!=destination){
			System.out.println("No Path!");
			return new ArrayList<Integer>(0);
		}
		return Stack;
		
	}
	
	
	
	public static void fordfulkerson(Integer source, Integer destination, WGraph graph, String filePath){
		String answer="";
		String myMcGillID = "260610696"; //Please initialize this variable with your McGill ID
		int maxFlow = 0;
		
				/* YOUR CODE GOES HERE
		//
		//
		//
		//
		//
		//
		//
		*/
		
		
		answer += maxFlow + "\n" + graph.toString();	
		writeAnswer(filePath+myMcGillID+".txt",answer);
		System.out.println(answer);
	}
	
	
	public static void writeAnswer(String path, String line){
		BufferedReader br = null;
		File file = new File(path);
		// if file doesnt exists, then create it
		
		try {
		if (!file.exists()) {
			file.createNewFile();
		}
		FileWriter fw = new FileWriter(file.getAbsoluteFile(),true);
		BufferedWriter bw = new BufferedWriter(fw);
		bw.write(line+"\n");	
		bw.close();
		} catch (IOException e) {
			e.printStackTrace();
		} finally {
			try {
				if (br != null)br.close();
			} catch (IOException ex) {
				ex.printStackTrace();
			}
		}
	}
	
	 public static void main(String[] args){
		 String file = args[0];
		 File f = new File(file);
		 WGraph g = new WGraph(file);	
		 System.out.println(g);
		 System.out.println(Arrays.toString(pathDFS(g.getSource(),g.getDestination(),g).toArray()));
		 //fordfulkerson(g.getSource(),g.getDestination(),g,f.getAbsolutePath().replace(".txt",""));
	 }
}
